@prefix : <http://football.org/ontology#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix spin: <http://spinrdf.org/spin#> .
@prefix sp: <http://spinrdf.org/sp#> .

# Additional Properties for Inferred Data
:efficiency a owl:DatatypeProperty ;
    rdfs:label "efficiency" ;
    rdfs:comment "Player efficiency rating based on goals+assists per 90 minutes" ;
    rdfs:domain :Player ;
    rdfs:range xsd:double .

:teammate a owl:ObjectProperty ;
    rdfs:label "teammate" ;
    rdfs:comment "Players who play for the same club" ;
    rdfs:domain :Player ;
    rdfs:range :Player .

:compatriot a owl:ObjectProperty ;
    rdfs:label "compatriot" ;
    rdfs:comment "Players from the same country" ;
    rdfs:domain :Player ;
    rdfs:range :Player .

:veteranStatus a owl:DatatypeProperty ;
    rdfs:label "veteran status" ;
    rdfs:comment "Whether a player is considered a veteran (35+ years old)" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:youngProspect a owl:DatatypeProperty ;
    rdfs:label "young prospect" ;
    rdfs:comment "Whether a player is a young prospect (under 23)" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:playerType a owl:DatatypeProperty ;
    rdfs:label "player type" ;
    rdfs:comment "Categorization based on playing style" ;
    rdfs:domain :Player ;
    rdfs:range xsd:string .

:penaltySpecialist a owl:DatatypeProperty ;
    rdfs:label "penalty specialist" ;
    rdfs:comment "Whether player is good at penalties (90%+ success rate)" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:playmaker a owl:DatatypeProperty ;
    rdfs:label "playmaker" ;
    rdfs:comment "Whether player is a playmaker (high assists and key passes)" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:goalThreat a owl:DatatypeProperty ;
    rdfs:label "goal threat" ;
    rdfs:comment "Whether player is a significant goal threat" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:disciplinaryRisk a owl:DatatypeProperty ;
    rdfs:label "disciplinary risk" ;
    rdfs:comment "Whether player has disciplinary issues" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:keyPlayer a owl:DatatypeProperty ;
    rdfs:label "key player" ;
    rdfs:comment "Whether player is key for their club (high minutes played)" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:versatilePlayer a owl:DatatypeProperty ;
    rdfs:label "versatile player" ;
    rdfs:comment "Player with balanced attacking and defensive stats" ;
    rdfs:domain :Player ;
    rdfs:range xsd:boolean .

:risingAge a owl:DatatypeProperty ;
    rdfs:label "rising age" ;
    rdfs:comment "Current age of the player" ;
    rdfs:domain :Player ;
    rdfs:range xsd:integer .

:leagueRival a owl:ObjectProperty ;
    rdfs:label "league rival" ;
    rdfs:comment "Clubs that are rivals in the same league and city" ;
    rdfs:domain :Club ;
    rdfs:range :Club .

# SPIN Rules

# Rule 1: Calculate Player Efficiency (Goals + Assists per 90 minutes)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :efficiency ?eff .
        }
        WHERE {
            ?player a :Player .
            ?player :gls ?goals .
            ?player :ast ?assists .
            ?player :min ?minutes .
            FILTER(?minutes > 0)
            BIND((?goals + ?assists) * 90.0 / ?minutes AS ?eff)
        }
    """ 
] .

# Rule 2: Identify Teammates
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player1 :teammate ?player2 .
        }
        WHERE {
            ?player1 a :Player .
            ?player2 a :Player .
            ?player1 :club ?club .
            ?player2 :club ?club .
            FILTER(?player1 != ?player2)
        }
    """
] .

# Rule 3: Identify Compatriots (same nationality)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player1 :compatriot ?player2 .
        }
        WHERE {
            ?player1 a :Player .
            ?player2 a :Player .
            ?player1 :nation ?country .
            ?player2 :nation ?country .
            FILTER(?player1 != ?player2)
        }
    """
] .

# Rule 4: Calculate Current Age
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :risingAge ?age .
        }
        WHERE {
            ?player a :Player .
            ?player :born ?birthYear .
            BIND(2025 - ?birthYear AS ?age)
        }
    """
] .

# Rule 5: Identify Veterans (35+ years old)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :veteranStatus true .
        }
        WHERE {
            ?player a :Player .
            ?player :born ?birthYear .
            FILTER(2025 - ?birthYear >= 35)
        }
    """
] .

# Rule 6: Identify Young Prospects (under 23)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :youngProspect true .
        }
        WHERE {
            ?player a :Player .
            ?player :born ?birthYear .
            FILTER(2025 - ?birthYear < 23)
        }
    """
] .

# Rule 7: Identify Penalty Specialists (90%+ penalty success rate)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :penaltySpecialist true .
        }
        WHERE {
            ?player a :Player .
            ?player :pk ?scored .
            ?player :pkatt ?attempted .
            FILTER(?attempted > 0 && (?scored * 1.0 / ?attempted) >= 0.9)
        }
    """
] .

# Rule 8: Identify Playmakers (high assists and key passes relative to games)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :playmaker true .
        }
        WHERE {
            ?player a :Player .
            ?player :ast ?assists .
            ?player :kp ?keyPasses .
            ?player :mp ?matches .
            FILTER(?matches > 0 && 
                   (?assists * 1.0 / ?matches) >= 0.3 && 
                   (?keyPasses * 1.0 / ?matches) >= 1.5)
        }
    """
] .

# Rule 9: Identify Goal Threats (high goals per game)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :goalThreat true .
        }
        WHERE {
            ?player a :Player .
            ?player :gls ?goals .
            ?player :mp ?matches .
            FILTER(?matches > 0 && (?goals * 1.0 / ?matches) >= 0.5)
        }
    """
] .

# Rule 10: Identify Disciplinary Risks (high cards per game)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :disciplinaryRisk true .
        }
        WHERE {
            ?player a :Player .
            ?player :crdy ?yellowCards .
            ?player :crdr ?redCards .
            ?player :mp ?matches .
            FILTER(?matches > 0 && 
                   ((?yellowCards + ?redCards * 2) * 1.0 / ?matches) >= 0.3)
        }
    """
] .

# Rule 11: Identify Key Players (play most minutes for their position)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :keyPlayer true .
        }
        WHERE {
            ?player a :Player .
            ?player :min ?minutes .
            ?player :mp ?matches .
            FILTER(?matches > 0 && (?minutes * 1.0 / ?matches) >= 70)
        }
    """
] .

# Rule 12: Classify Player Types based on statistics
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :playerType "Striker" .
        }
        WHERE {
            ?player a :Player .
            ?player :gls ?goals .
            ?player :mp ?matches .
            ?player :position ?pos .
            FILTER(?matches > 0 && 
                   (?goals * 1.0 / ?matches) >= 0.4 &&
                   (CONTAINS(LCASE(?pos), "forward") || CONTAINS(LCASE(?pos), "striker")))
        }
    """
] .

:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :playerType "Defensive Midfielder" .
        }
        WHERE {
            ?player a :Player .
            ?player :tkl ?tackles .
            ?player :int ?interceptions .
            ?player :mp ?matches .
            ?player :position ?pos .
            FILTER(?matches > 0 && 
                   ((?tackles + ?interceptions) * 1.0 / ?matches) >= 3.0 &&
                   CONTAINS(LCASE(?pos), "midfield"))
        }
    """
] .

# Rule 13: Identify Versatile Players (good in multiple areas)
:Player spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?player :versatilePlayer true .
        }
        WHERE {
            ?player a :Player .
            ?player :gls ?goals .
            ?player :ast ?assists .
            ?player :tkl ?tackles .
            ?player :mp ?matches .
            FILTER(?matches > 0 && 
                   (?goals * 1.0 / ?matches) >= 0.1 &&
                   (?assists * 1.0 / ?matches) >= 0.1 &&
                   (?tackles * 1.0 / ?matches) >= 1.0)
        }
    """
] .

# Rule 14: Infer club rivalries based on same league/country
:Club spin:rule [
    a sp:Construct ;
    sp:text """
        CONSTRUCT {
            ?club1 :leagueRival ?club2 .
        }
        WHERE {
            ?club1 a :Club .
            ?club2 a :Club .
            ?club1 :league ?league .
            ?club2 :league ?league .
            ?club1 :city ?city1 .
            ?club2 :city ?city2 .
            FILTER(?club1 != ?club2 && ?city1 = ?city2)
        }
    """
] .